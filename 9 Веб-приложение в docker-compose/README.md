# Инструкции docker-compose
- versions: версия (будем использовать 3ю)
- services: наши контейнеры
- volumes: вольюмы (томы)
- networks: сеть

## volumes
```YAML
# Можем не указывать имя БД, поулчим имя: имя папки + имя бд
volumes:
    todo_db:

# Или укажем имя явно
volumes:
    todo_db:
        name: todo_db
```

## network
С сетью аналогично:
```YAML
networks:
    todo_net:
        name: todo_net
```

Важные доп. функции docker-compose:
- ```restart``` и ```restart_policy``` - перезапуск контейнера
- ```replicas``` - количество копий контейнера, которые нужно поднять
- ```depends_on``` - выставляет зависимость одного контейнера от другого
- ```healthcheck``` - запустить некую проверку после поднятия контейнера (например БД при поднятии не сразу может быть готова к работе)


# Веб приложение в docker-compose
см docker-compose.yaml
# Расширяем docker-compose файл
см docker-compose.yaml
После указания зависимостей у нас установился порядок запуска контейнеров.
# Сокращаем docker-compose файл
По умолчанию docker-compose создает сеть. Закомменитруем сеть и инструкции подключения к сети у сервисов. Docker-compose сам поднял сеть с названием (папки+default). При остановке контейнеров, docker-compose сам удалить эту сеть. С вольюмом аналогично, только docker-compose не удаляет его при остановке. 

А теперь удалим имена контейнеров. Все собралось, получили имена контейнеров (папка + название сервиса и -1).  Но теперь вопрос, что указывать в HOST backend? А можно указать не имя контейнера, а название сервиса. И все заработало.

А сейчас посмотрим, что за единичка добавляется к именам контейнеров. допишем у базы данных:
```YAML
deploy:
      replicas: 3
```
И попробуем запустить. Теперь поднимается 3 базы данных. 


## Крутая фишка
Если мы изменили docker-compose и хотим перезапустить контейнеры, то не их выключать, достаточно запустить их снова, а docker-compose сам разберется:
```bash
docker-compose up -d
```